<include/components/encoder.conf>

Object.Pipeline.host-gateway-capture [
	{
		index 25

		Object.Widget.host-copier.1 {
			stream_name	"Jack Compress In"
			pcm_id 51
			num_input_audio_formats 1
			Object.Base.input_audio_format [
				{
					in_rate	$JACK_RATE
					in_bit_depth 16
					in_valid_bit_depth 16
				}
			]
			IncludeByKey.PCM_FORMAT_ALL {
				"true" {
					num_output_audio_formats 5
					Object.Base.output_audio_format [
						{
							out_rate		$JACK_RATE
							out_bit_depth		16
							out_valid_bit_depth	16
						}
						{
							out_rate		$JACK_RATE
							out_bit_depth		32
							out_valid_bit_depth	24
						}
						{
							out_rate		$JACK_RATE
							out_bit_depth		32
							out_valid_bit_depth	32
						}
						{
							out_rate		$JACK_RATE
							out_bit_depth		32
							out_valid_bit_depth	32
							out_sample_type		$SAMPLE_TYPE_FLOAT
						}
						{
							out_rate		$JACK_RATE
							out_bit_depth		8
							out_valid_bit_depth	8
							out_sample_type		$SAMPLE_TYPE_UNSIGNED_INTEGER
						}
					]
				}
				"false" {
					num_output_audio_formats 3
					Object.Base.output_audio_format [
						{
							out_rate		$JACK_RATE
							out_bit_depth		16
							out_valid_bit_depth	16
						}
						{
							out_rate		$JACK_RATE
							out_bit_depth		32
							out_valid_bit_depth	24
						}
						{
							out_rate		$JACK_RATE
							out_bit_depth		32
							out_valid_bit_depth	32
						}
					]
				}
			}
		}
	}
]

Object.Widget.encoder.1 {
		index 25
		core_id 1
		scheduler_domain "DP"
		num_input_audio_formats 1
		Object.Base.input_audio_format [
			{
				in_rate	48000
				in_bit_depth 16
				in_valid_bit_depth 16
			}
		]

		num_output_audio_formats 1
		Object.Base.output_audio_format [
			{
				out_rate 48000
				out_bit_depth 16
				out_valid_bit_depth 16
			}
		]
}


# converts the input to S32_LE
Object.Widget.module-copier.1 {
	index 11
	num_input_audio_formats 1
	Object.Base.input_audio_format [
		{
			in_rate	48000
			in_bit_depth 32
			in_valid_bit_depth 32
		}
	]

	num_output_audio_formats 1
	Object.Base.output_audio_format [
		{
			out_rate 48000
			out_bit_depth 16
			out_valid_bit_depth 16
		}
	]
}

Object.PCM.pcm [
	{
		name "Jack Compress In"
		id 51
		direction capture
		compress "true"

		Object.Base.fe_dai.1 {
			name "Jack Compress In"
		}

		Object.PCM.pcm_caps.1 {
			name "Jack Compress In"
			formats 'S32_LE'
			rates '48000'
		}
	}
]

Object.Base.route [
	{
		source  module-copier.11.1
		sink	encoder.25.1
	}
	{
		source  encoder.25.1
		sink	host-copier.51.capture
	}
]